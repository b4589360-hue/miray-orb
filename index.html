recognition.onresult = (event) => {
  const raw = event.results[0][0].transcript.trim();
  const command = raw.toLowerCase();
  statusText.innerText = "Dedin ki: " + raw;

  // Sorguyu yakala:
  // 1) "araştır ..." -> araştır'dan sonrasını al
  // 2) "nedir/ne demek/kimdir/nasıl" -> tüm cümleyi sorgu say
  let query = "";

  if (command.includes("araştır")) {
    query = raw.toLowerCase().split("araştır").pop().trim();
  } else if (
    command.includes("nedir") ||
    command.includes("ne demek") ||
    command.includes("kimdir") ||
    command.includes("nasıl")
  ) {
    query = raw.trim();
  }

  // Basit cevaplar
  if (command.includes("merhaba")) {
    speak("Efendim Bünyamin");
    return;
  }
  if (command.includes("nasılsın")) {
    speak("Elhamdülillah, siz nasılsınız");
    return;
  }

  // Araştırma cevabı (şimdilik özet)
  if (query) {
    speak(`${query} konusunda kısa bir özet sunayım.`);

    if (query.includes("sabır")) {
      speak("Sabır, Allah rızası için zorluğa dayanmak; acele edip vazgeçmemek, dil ve davranışta taşkınlık göstermemektir. Üç yönü vardır: musibete sabır, günaha karşı sabır ve ibadete devamda sabır. Sabır, kalbi olgunlaştırır ve insanı istikamette tutar.");
    } else {
      speak("Bu konuyu biraz daha açar mısınız Bünyamin? İsterseniz bir cümleyle neyi özellikle merak ettiğinizi söyleyin.");
    }
    return;
  }

  speak("Anlayamadım Bünyamin. Örnek: 'Sabır nedir araştır' ya da 'Sabır nedir?'");
};